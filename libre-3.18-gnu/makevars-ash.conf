###########
##### !/bin/bash
# This is the result of my personal experiences with pentium3, athlon-xp, prescott,
# nocona, athlon64-X2, atom - processors which I own or owned, together
# with hints from manufacturers literature and the sandpiler in the internet www.sandpile.org
#
#  The settings are specially for the use of common available and marketed processors
#  and computing machines from the Intel/AMD mainstream originating the x86 Architecture from i486 on
#
#  With the generation of instruction sets , the processor architecture families
#  are trespassed and one optimized way to all processors is kept through.
#  The aim is to have a software with the possibility to communicate
#  within the x86 PC supported world
#  (c) Dieter Miosga , 2008-2015-03-21 gcc-4.9.2-last, binutils-2.25 gnu.org, 2.24.52.0.3 kernel.org

 OPTEXT=""
 FLAGS="dummy"
 GENFLAG=""
 ARCHFLAG=""
 PROCFLAG=""
 EXTENT=""

#declare -a CFLAG
#declare -a GENFLAGS
#declare -a ARCHFLAGS
#declare -a ARCHPROC
#declare -a OPTIMIZE
#declare -a EXTENSION
#CFLAG=""
#GENFLAGS=""
#ARCHFLAGS=""
#ARCHPROC=""
#OPTIMIZE=""
#EXTENSION=""

OPTIMIZE_x86="-O2"
OPTIMIZE_x86Os="-Os"
OPTIMIZE_x86mmx="-O2"
OPTIMIZE_x86mmxOs="-Os"
OPTIMIZE_k6p3="-O2"
OPTIMIZE_k7p4="-O2"
OPTIMIZE_k8p5="-O2"
OPTIMIZE_k8EM64T="-O2"
OPTIMIZE_k9c2="-O2"
OPTIMIZE_coreavx="-O2"
OPTIMIZE_atom="-O2"
OPTIMIZE_k10="-O2"
OPTIMIZE_nk10="-O2"
OPTIMIZE_k9="-O2"
OPTIMIZE_k8="-O2"
OPTIMIZE_k7="-O2"
OPTIMIZE_k6="-O2"
OPTIMIZE_k5="-O2"
OPTIMIZE_init="-O2"
OPTIMIZE_soft="-O2"
OPTIMIZE_corex="-O2"
OPTIMIZE_k15="-O2"
OPTIMIZE_nativek15="-O2"
OPTIMIZE_k14="-O2"
OPTIMIZE_k16="-O2"
OPTIMIZE_nativeavx="-O2"
OPTIMIZE_nativefpu="-O2"
OPTIMIZE_allmodmmx="-Os"

EXTENSIONS="1 2 3 4 5 6 8 7 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28"
EXTENTS="x86 x86Os x86mmx x86mmxOs k6p3 k7p4 k8p5 k8EM64T atom k9c2 coreavx nk10 k10 k9 k8 k7 k6 k5 init soft corex  k15 nativek15 k14 k16 nativefpu nativeavx allmodmmx"

#         i386 is not respected!
#   fpu:  486 pentium pentium-overdrive
CFLAG_x86=" -Wall -Wextra -Wno-unused -Wno-unused-parameter -Wno-system-headers -Wno-uninitialized -Wno-missing-field-initializers -Wno-strict-aliasing  -Wno-conversion  -Wno-system-headers -Wno-empty-body -Wstrict-prototypes  -Wunsafe-loop-optimizations  -Wdisabled-optimization   -Wa,-msse-check=warning -g0 -O2 -fgcse-las -fgcse-sm   -fomit-frame-pointer -momit-leaf-frame-pointer -mhard-float -march=i486 -mtune=generic -ffast-math -mpreferred-stack-boundary=2 -fno-exceptions -fno-math-errno -fno-trapping-math  -fno-jump-tables  -fno-var-tracking-assignments  -fno-delete-null-pointer-checks -fno-tracer -fno-stack-protector   -ffreestanding  --param max-inline-insns-single=131072 --param inline-unit-growth=350   "
GENFLAGS_x86=" -fmerge-all-constants"
ARCHFLAGS_x86=" -ffast-math "
ARCHPROC_x86=" -march=i486 -mtune=generic -mpreferred-stack-boundary=2 -fno-stack-protector  -fno-strict-aliasing -fno-var-tracking-assignments"
EXTENSION_x86="x86"

# fpu: 486 pentium pentium-overdrive  - optimized for code size
CFLAG_x86Os="  -Wall -Wextra -Wno-unused -Wno-unused-parameter -Wno-system-headers -Wno-uninitialized -Wno-missing-field-initializers -Wno-strict-aliasing  -Wno-conversion  -Wno-system-headers -Wno-empty-body -Wstrict-prototypes  -Wunsafe-loop-optimizations  -Wdisabled-optimization   -Wa,-msse-check=warning -g0  -O2 -fomit-frame-pointer -momit-leaf-frame-pointer -mhard-float  -march=i486 -mtune=generic -mpreferred-stack-boundary=2  -ffast-math  -mfpmath=387  -ffreestanding  -fno-exceptions -fno-math-errno -fno-trapping-math  -fno-jump-tables  -fno-var-tracking-assignments  -fno-delete-null-pointer-checks       -fno-tracer -fno-stack-protector --param max-inline-insns-single=131072 --param inline-unit-growth=350   "
GENFLAGS_x86Os="-fmerge-all-constants"
ARCHFLAGS_x86Os=" -ffast-math "
ARCHPROC_x86Os=" -march=i486 -mtune=generic -mpreferred-stack-boundary=2 -fno-stack-protector  -fno-strict-aliasing -fno-var-tracking-assignments"
EXTENSION_x86Os="x86Os"

# mmx:  pentium-mmx athlon duron pentiumpro - optimized for speed 
CFLAG_x86mmx="  -Wall -Wextra -Wno-unused -Wno-unused-parameter -Wno-system-headers -Wno-uninitialized -Wno-missing-field-initializers -Wno-strict-aliasing  -Wno-conversion  -Wno-system-headers -Wno-empty-body -Wstrict-prototypes  -Wunsafe-loop-optimizations  -Wdisabled-optimization   -Wa,-msse-check=warning,-mtune=generic32 -g0 ${OPTIMIZE_x86mmx}  -fgcse-las -fgcse-sm  -fomit-frame-pointer -momit-leaf-frame-pointer -mhard-float   -mtune=i586  -march=pentium-mmx  -mmmx -mno-3dnow  -ffast-math   -mfpmath=387 -mpreferred-stack-boundary=3 -ffreestanding   -fno-exceptions -fno-math-errno -fno-trapping-math   -fno-jump-tables  -fno-var-tracking-assignments  -fno-delete-null-pointer-checks   -fno-tracer -fno-stack-protector  --param max-inline-insns-single=131072 --param inline-unit-growth=350   "
GENFLAGS_x86mmx="-fmerge-all-constants"
ARCHFLAGS_x86mmx=" -mmmx  -mno-sse  -mno-sse2 -mno-sse3 -mno-3dnow -mno-sse4 -mno-ssse3 "
ARCHPROC_x86mmx=" -march=pentium-mmx  -mtune=generic -mpreferred-stack-boundary=3 -fno-stack-protector  -fno-strict-aliasing -fno-var-tracking-assignments"
EXTENSION_x86mmx="x86mmx"

# mmx:  pentium-mmx athlon duron pentiumpro - optimized for code size
CFLAG_x86mmxOs="  -Wall -Wextra -Wno-unused -Wno-unused-parameter -Wno-system-headers -Wno-uninitialized -Wno-missing-field-initializers -Wno-strict-aliasing  -Wno-conversion  -Wno-system-headers -Wno-empty-body -Wstrict-prototypes  -Wunsafe-loop-optimizations  -Wdisabled-optimization   -Wa,-msse-check=warning,-mtune=generic32 -g0 ${OPTIMIZE_x86mmxOs}  -fomit-frame-pointer -momit-leaf-frame-pointer -mhard-float   -march=i586  -mtune=pentium-mmx  -mmmx -mno-3dnow -ffast-math   -mpreferred-stack-boundary=2  -ffreestanding  -fno-exceptions -fno-math-errno -fno-trapping-math  -fno-jump-tables   -fno-delete-null-pointer-checks    -fno-var-tracking-assignments    -fno-tracer -fno-stack-protector --param max-inline-insns-single=131072 --param inline-unit-growth=350  "
GENFLAGS_x86mmxOs="-fmerge-all-constants"
ARCHFLAGS_x86mmxOs=" -mmmx -mno-sse -mno-sse2 -mno-sse3 -mno-3dnow -mno-sse4 -mno-ssse3  "
ARCHPROC_x86mmxOs=" -march=i586 -mtune=generic -mpreferred-stack-boundary=2 -fno-stack-protector  -fno-strict-aliasing -fno-var-tracking-assignments"
EXTENSION_x86mmxOs="x86mmxOs"

# sse:  pentium3 athlon-xp sempron coppermine tualatin barton - optimized for speed over sse1
CFLAG_k6p3=" -Wall -Wstrict-prototypes -Wa,-msse-check=warning -Wextra -Wno-unused -Wno-unused-parameter -Wno-system-headers -Wno-uninitialized -Wno-missing-field-initializers -Wno-strict-aliasing  -Wno-conversion  -Wno-system-headers -Wno-empty-body -Wstrict-prototypes  -Wunsafe-loop-optimizations  -Wdisabled-optimization -g0 ${OPTIMIZE_k6p3} -fpeel-loops  -fgcse-las -fgcse-sm    -fomit-frame-pointer -momit-leaf-frame-pointer -mhard-float    -march=i686  -mtune=generic  -mmmx -mno-3dnow    -ffast-math -mpreferred-stack-boundary=3 -ffreestanding -fno-exceptions -fno-math-errno -fno-trapping-math  -fno-jump-tables   -fno-delete-null-pointer-checks  -fno-var-tracking-assignments -fno-tracer -fno-stack-protector    --param max-inline-insns-single=131072 --param inline-unit-growth=350  "
GENFLAGS_k6p3=" -fmerge-all-constants "
ARCHFLAGS_k6p3=" -msse  -msseregparm -mfpmath=387,sse -mno-sse2 -mno-sse3 -mno-3dnow -mno-sse4 -mno-ssse3   "
ARCHPROC_k6p3=" -march=i686  -mtune=generic -mmmx -mpreferred-stack-boundary=3 -fno-stack-protector  -fno-strict-aliasing -fno-var-tracking-assignments"
EXTENSION_k6p3="k6p3"

# sse2: pentium4, pentium-m, athlon-xp, sempron - optimized for speed over sse2
#       no explicit EM64T/x86-64 support however such programs will run if machine supports
CFLAG_k7p4="  -Wall  -Wextra -Wno-unused -Wno-unused-parameter -Wno-system-headers -Wno-uninitialized -Wno-missing-field-initializers -Wno-strict-aliasing  -Wno-conversion  -Wno-system-headers -Wno-empty-body -Wstrict-prototypes  -Wunsafe-loop-optimizations  -Wdisabled-optimization   -Wa,-msse-check=warning -g0  ${OPTIMIZE_k7p4} -fpeel-loops -fgcse-las -fgcse-sm    -fomit-frame-pointer -momit-leaf-frame-pointer -mhard-float   -march=i686 -mtune=generic  -mmmx -mno-3dnow -mfpmath=387   -ffast-math -mpreferred-stack-boundary=4  -fno-exceptions -fno-math-errno -ffreestanding -fno-trapping-math  -fno-jump-tables  -fno-var-tracking-assignments  -fno-delete-null-pointer-checks  -fno-tracer -fno-stack-protector   --param max-inline-insns-single=131072 --param inline-unit-growth=350  "
GENFLAGS_k7p4="  -fmerge-all-constants"
ARCHFLAGS_k7p4=" -msse -msse2  -mfpmath=sse -msseregparm -m96bit-long-double -mno-sse3 -mno-3dnow -mno-sse4 -mno-ssse3   "
ARCHPROC_k7p4=" -march=i686 -mtune=generic -mmmx -mpreferred-stack-boundary=4 -fno-stack-protector  -fno-strict-aliasing -fno-var-tracking-assignments"
EXTENSION_k7p4="k7p4"

# sse3:  prescott athlon64 athlon-fx nocona athlon-X2 opteron (k8-sse3 family)
#        no explicit EM64T/x86-64 support - optimized for speed over sse3
CFLAG_k8p5="  -Wall -Wextra -Wno-unused -Wno-unused-parameter -Wno-system-headers -Wno-uninitialized -Wno-missing-field-initializers -Wno-strict-aliasing  -Wno-conversion  -Wno-system-headers -Wno-empty-body -Wstrict-prototypes  -Wunsafe-loop-optimizations  -Wdisabled-optimization   -Wa,-msse-check=warning ${OPTIMIZE_k8p5} -g0 -fpeel-loops -fgcse-las -fgcse-sm -fomit-frame-pointer -momit-leaf-frame-pointer -mhard-float   -march=prescott  -mtune=generic   -mmmx -mno-3dnow   -ffast-math -mfpmath=387 -mpreferred-stack-boundary=4 -ffreestanding -fno-exceptions -fno-math-errno -fno-trapping-math  -fno-jump-tables  -fno-var-tracking-assignments  -fno-delete-null-pointer-checks  -fno-tracer -fno-stack-protector   --param max-inline-insns-single=131072 --param inline-unit-growth=350  "
GENFLAGS_k8p5="  -fmerge-all-constants"
ARCHFLAGS_k8p5=" -msse -msse2 -msse3  -mfpmath=sse -m128bit-long-double -mno-3dnow -mno-sse4a -mno-sse4 -mno-ssse3  "
ARCHPROC_k8p5=" -march=prescott   -mtune=generic -g0 -mpreferred-stack-boundary=4 -fno-stack-protector  -fno-strict-aliasing -fno-var-tracking-assignments"
EXTENSION_k8p5="k8p5"


# sse3:  prescott athlon64 athlon-fx nocona athlon-X2 opteron (k8-sse3 family)
#        no explicit EM64T/x86-64 support - optimized for speed over sse3
CFLAG_k8EM64T="  -Wall -Wextra -Wno-unused -Wno-unused-parameter -Wno-system-headers -Wno-uninitialized -Wno-missing-field-initializers -Wno-strict-aliasing  -Wno-conversion  -Wno-system-headers -Wno-empty-body -Wstrict-prototypes  -Wunsafe-loop-optimizations  -Wdisabled-optimization   -Wa,-msse-check=warning ${OPTIMIZE_k8EM64T} -g0 -fpeel-loops -fgcse-las -fgcse-sm -fomit-frame-pointer -momit-leaf-frame-pointer -mhard-float  -march=nocona  -mtune=prescott  -mmmx -mno-3dnow  -mno-movbe -ffast-math -mfpmath=387 -mpreferred-stack-boundary=4 -ffreestanding -fno-exceptions -fno-math-errno -fno-trapping-math  -fno-jump-tables  -fno-var-tracking-assignments  -fno-delete-null-pointer-checks  -fno-tracer -fno-stack-protector   --param max-inline-insns-single=131072 --param inline-unit-growth=350  "
GENFLAGS_k8EM64T="  -fmerge-all-constants"
ARCHFLAGS_k8EM64T=" -msse -msse2 -msse3  -mfpmath=sse -m128bit-long-double -mno-3dnow -mno-sse4a -mno-sse4 -mno-ssse3  "
ARCHPROC_k8EM64T=" -march=nocona   -mtune=generic -g0 -mpreferred-stack-boundary=4 -fno-stack-protector  -fno-strict-aliasing -fno-var-tracking-assignments"
EXTENSION_k8EM64T="k8EM64T"



#         AMD K9-10/Opteron has no ssse3
# ssse3 : EM64T 7 - optimized for speed over ssse3 for core2/iX/EM64T, covers: penryn atom
CFLAG_atom="  -Wall -Wextra -Wno-unused -Wno-unused-parameter -Wno-system-headers -Wno-uninitialized -Wno-missing-field-initializers -Wno-strict-aliasing  -Wno-conversion  -Wno-system-headers -Wno-empty-body -Wstrict-prototypes  -Wunsafe-loop-optimizations  -Wdisabled-optimization -Wa,-msse-check=warning -g0 ${OPTIMIZE_atom} -funsafe-loop-optimizations -fexpensive-optimizations  -fomit-frame-pointer -momit-leaf-frame-pointer -mhard-float -march=atom -mtune=atom -mmmx -mno-3dnow -mfpmath=387 -mfancy-math-387 -mpreferred-stack-boundary=4 -ffreestanding  -fno-exceptions -fno-math-errno -fno-trapping-math -funsafe-loop-optimizations -fno-jump-tables  -fno-var-tracking-assignments  -fno-delete-null-pointer-checks  -fno-tracer -fno-stack-protector   --param max-inline-insns-single=131072 --param inline-unit-growth=350   "
GENFLAGS_atom=" -fmerge-all-constants "
ARCHFLAGS_atom=" -msse -msse2 -msse3 -mssse3 -msseregparm -mno-sse4 -mfpmath=sse  "
ARCHPROC_atom=" -march=atom  -mtune=generic -g0 -mpreferred-stack-boundary=4 -fno-stack-protector -fno-strict-aliasing -fno-var-tracking-assignments"
EXTENSION_atom="atom"

# sse4: subset of instructions common for: nocona clarksfield core2 core i3/i5/i7 amd-fam9/10 athlon-fx athlon-x2 barcelona phenom opteron64,
#       no sse4x is itself integrated to achieve compatibility
#       optimized for speed over sse3 with EM64T/x86-64
CFLAG_k9c2="  -Wall -Wextra -Wno-unused -Wno-unused-parameter -Wno-system-headers -Wno-uninitialized -Wno-missing-field-initializers -Wno-strict-aliasing  -Wno-conversion  -Wno-system-headers -Wno-empty-body -Wstrict-prototypes  -Wunsafe-loop-optimizations  -Wdisabled-optimization   -Wa,-msse-check=warning -g0 ${OPTIMIZE_k9c2}  -fpeel-loops -fgcse-las -fgcse-sm  -fomit-frame-pointer -momit-leaf-frame-pointer -mhard-float   -march=nocona  -mtune=generic  -mmmx -mno-3dnow -ffast-math   -mfpmath=387 -mpreferred-stack-boundary=4 -ffreestanding  -fno-exceptions -fno-math-errno -fno-trapping-math  -fno-jump-tables  -fno-var-tracking-assignments  -fno-delete-null-pointer-checks  -fno-tracer -fno-stack-protector   --param max-inline-insns-single=131072 --param inline-unit-growth=350   "
GENFLAGS_k9c2=" -fmerge-all-constants "
ARCHFLAGS_k9c2=" -msse -msse2 -msse3  -m128bit-long-double -mfpmath=sse -mno-3dnow -mno-sse4 -mno-ssse3 -mno-sse4a   "
ARCHPROC_k9c2=" -march=nocona  -mtune=generic -mmmx -mpreferred-stack-boundary=4 -fno-stack-protector  -fno-strict-aliasing -fno-var-tracking-assignments"
EXTENSION_k9c2="k9c2"

# sse4.1/sse4.2: Intel core i3 i5 i7 with SSE4.1 and SSE4.2 Nehalem
#       optimized for speed over sse4.x with EM64T/x86-64
CFLAG_coreavx="  -Wall -Wextra -Wno-unused -Wno-unused-parameter -Wno-system-headers -Wno-uninitialized -Wno-missing-field-initializers -Wno-strict-aliasing  -Wno-conversion  -Wno-system-headers -Wno-empty-body -Wstrict-prototypes  -Wunsafe-loop-optimizations  -Wdisabled-optimization   -Wa,-msse-check=warning -g0 ${OPTIMIZE_coreavx}  -fgcse-las -fgcse-sm  -fomit-frame-pointer -momit-leaf-frame-pointer -mhard-float   -march=corei7-avx   -mtune=corei7-avx  -mmmx -mno-3dnow -fpeel-loops -ffast-math -msse2avx -funsafe-loop-optimizations  -mpreferred-stack-boundary=4 -ffreestanding  -fno-exceptions -fno-math-errno -fno-trapping-math  -fno-jump-tables  -fno-var-tracking-assignments  -fno-delete-null-pointer-checks  -fno-tracer -fno-stack-protector   --param max-inline-insns-single=131072 --param inline-unit-growth=350   "
GENFLAGS_coreavx=" -fmerge-all-constants "
ARCHFLAGS_coreavx=" -msse -msse2 -msse3 -msse4 -m128bit-long-double -mno-3dnow  -mssse3 -mno-sse4a -mcx16 -msahf "
ARCHPROC_coreavx=" -march=corei7-avx -mtune=generic -g0 -mmmx -mpreferred-stack-boundary=4 -fno-stack-protector  -fno-strict-aliasing -fno-var-tracking-assignments"
EXTENSION_coreavx="coreavx"

# sse4a: AMD family 10 processors: Phenom-Xi/Barcelona/AthlonII-Xi  with sse4a
#       optimized for speed over sse4.x 3dnowext with EM64T/x86-64
CFLAG_k10="  -Wall -Wextra -Wno-unused -Wno-unused-parameter -Wno-system-headers -Wno-uninitialized -Wno-missing-field-initializers -Wno-strict-aliasing  -Wno-conversion  -Wno-system-headers -Wno-empty-body -Wstrict-prototypes  -Wunsafe-loop-optimizations  -Wdisabled-optimization   -Wa,-msse-check=warning -g0 ${OPTIMIZE_k10} -fpeel-loops -fgcse-las -fgcse-sm  -fomit-frame-pointer -momit-leaf-frame-pointer -mhard-float   -march=amdfam10   -mtune=amdfam10  -mmmx -m3dnow -ffast-math  -mfpmath=387   -mpreferred-stack-boundary=4 -ffreestanding  -fno-exceptions -fno-math-errno -fno-trapping-math  -fno-jump-tables   -fno-var-tracking-assignments -fno-delete-null-pointer-checks  -fno-tracer -fno-stack-protector   --param max-inline-insns-single=131072 --param inline-unit-growth=350   "
GENFLAGS_k10=" -fmerge-all-constants "
ARCHFLAGS_k10=" -msse -msse2 -msse3 -mcx16 -msahf -mfpmath=sse -m128bit-long-double -m3dnow -msse4a  -mno-ssse3 -mno-sse4.1 -mno-sse4.2  "
ARCHPROC_k10=" -march=amdfam10 -mtune=generic -Wa,-mtune=generic32 -g0 -mpreferred-stack-boundary=4 -fno-stack-protector  -fno-strict-aliasing -fno-var-tracking-assignments"
EXTENSION_k10="k10"

# sse4a: AMD family 10 processors: Phenom-Xi/Barcelona/AthlonII-Xi  with sse4a
#       optimized for speed over sse4.x 3dnowext with EM64T/x86-64
CFLAG_nk10="  -Wall -Wextra -Wno-unused -Wno-unused-parameter -Wno-system-headers -Wno-uninitialized -Wno-missing-field-initializers -Wno-strict-aliasing  -Wno-conversion  -Wno-system-headers -Wno-empty-body -Wstrict-prototypes  -Wunsafe-loop-optimizations  -Wdisabled-optimization   -Wa,-msse-check=warning -g0 ${OPTIMIZE_nk10} -fpeel-loops -fgcse-las -fgcse-sm  -fomit-frame-pointer -momit-leaf-frame-pointer -mhard-float   -march=nocona -mtune=amdfam10 -mno-movbe  -mmmx -mno-3dnow -ffast-math  -mfpmath=387   -mpreferred-stack-boundary=4 -ffreestanding  -fno-exceptions -fno-math-errno -fno-trapping-math  -fno-jump-tables   -fno-var-tracking-assignments -fno-delete-null-pointer-checks  -fno-tracer -fno-stack-protector   --param max-inline-insns-single=131072 --param inline-unit-growth=350   "
GENFLAGS_nk10=" -fmerge-all-constants "
ARCHFLAGS_nk10=" -msse -msse2 -msse3 -mcx16 -msahf -mfpmath=sse -m128bit-long-double -mno-3dnow -mno-movbe -msse4a  -mno-ssse3 -mno-sse4 "
ARCHPROC_nk10=" -march=nocona -mtune=generic -Wa,-mtune=generic32 -g0 -mpreferred-stack-boundary=4 -fno-stack-protector -fno-strict-aliasing -fno-var-tracking-assignments"
EXTENSION_nk10="nk10"

# sse3: AMD family 9 processors: Opteron64 Athlon64-X2 Phenom/Barcelona/AthlonXn  with sse3/pni
#       optimized for speed over sse3 3dnowext with x86-64
CFLAG_k9="  -Wall -Wextra -Wno-unused -Wno-unused-parameter -Wno-system-headers -Wno-uninitialized -Wno-missing-field-initializers -Wno-strict-aliasing  -Wno-conversion  -Wno-system-headers -Wno-empty-body -Wstrict-prototypes  -Wunsafe-loop-optimizations  -Wdisabled-optimization   -Wa,-msse-check=warning -g0 ${OPTIMIZE_k9} -fpeel-loops -fgcse-las -fgcse-sm  -fomit-frame-pointer -momit-leaf-frame-pointer -mhard-float   -march=k8-sse3   -mtune=k8-sse3  -mmmx -m3dnow  -ffast-math    -mpreferred-stack-boundary=4 -ffreestanding  -fno-exceptions -fno-math-errno -fno-trapping-math  -fno-jump-tables   -fno-delete-null-pointer-checks  -fno-var-tracking-assignments -fno-tracer -fno-stack-protector    --param max-inline-insns-single=131072 --param inline-unit-growth=350   "
GENFLAGS_k9=" -fmerge-all-constants "
ARCHFLAGS_k9=" -msse -msse2 -msse3  -mfpmath=sse  -m128bit-long-double -m3dnow -mno-sse4a  -mno-ssse3 -mno-sse4.1 -mno-sse4.2  "
ARCHPROC_k9=" -march=k8-sse3 -mtune=generic -g0 -mpreferred-stack-boundary=4 -fno-stack-protector  -fno-strict-aliasing -fno-var-tracking-assignments"
EXTENSION_k9="k9"

# sse2: AMD family 8 processors: Opteron64 Athlon64 with sse2
#       optimized for speed over sse2 3dnowext with x86-64
CFLAG_k8="  -Wall -Wextra -Wno-unused -Wno-unused-parameter -Wno-system-headers -Wno-uninitialized -Wno-missing-field-initializers -Wno-strict-aliasing  -Wno-conversion  -Wno-system-headers -Wno-empty-body -Wstrict-prototypes  -Wunsafe-loop-optimizations  -Wdisabled-optimization   -Wa,-msse-check=warning  -g0 ${OPTIMIZE_k8} -fpeel-loops -fgcse-las -fgcse-sm  -fomit-frame-pointer -momit-leaf-frame-pointer -mhard-float   -march=k8   -mtune=k8  -mmmx -m3dnow -ffast-math -mfpmath=387   -mpreferred-stack-boundary=4 -ffreestanding  -fno-exceptions -fno-math-errno -fno-trapping-math  -fno-jump-tables   -fno-delete-null-pointer-checks  -fno-var-tracking-assignments -fno-tracer -fno-stack-protector   --param max-inline-insns-single=131072 --param inline-unit-growth=350   "
GENFLAGS_k8=" -fmerge-all-constants "
ARCHFLAGS_k8=" -msse -msse2 -mno-sse3  -mfpmath=sse -m96bit-long-double -m3dnow -mno-sse4a  -mno-ssse3 -mno-sse4.1 -mno-sse4.2   "
ARCHPROC_k8=" -march=k8 -mtune=generic -g0 -mpreferred-stack-boundary=4 -fno-stack-protector  -fno-strict-aliasing -fno-var-tracking-assignments"
EXTENSION_k8="k8"

# sse: AMD family 7 processors: Athlon-4/-XP, Sempron, Opteron, Barton-core with sse
#       optimized for speed over sse1 3dnow 3dnowext without x86-64
CFLAG_k7="  -Wall -Wextra -Wno-unused -Wno-unused-parameter -Wno-system-headers -Wno-uninitialized -Wno-missing-field-initializers -Wno-strict-aliasing  -Wno-conversion  -Wno-system-headers -Wno-empty-body -Wstrict-prototypes  -Wunsafe-loop-optimizations  -Wdisabled-optimization   -Wa,-msse-check=warning,-mtune=generic32 -g0 ${OPTIMIZE_k7} -fpeel-loops -fgcse-las -fgcse-sm  -fomit-frame-pointer -momit-leaf-frame-pointer -mhard-float   -march=athlon  -mtune=athlon-4 -mmmx -m3dnow -mfpmath=387 -ffast-math   -mpreferred-stack-boundary=3 -ffreestanding  -fno-exceptions -fno-math-errno -fno-trapping-math  -fno-jump-tables  -fno-var-tracking-assignments  -fno-delete-null-pointer-checks  -fno-tracer -fno-stack-protector   --param max-inline-insns-single=131072 --param inline-unit-growth=350   "
GENFLAGS_k7=" -fmerge-all-constants "
ARCHFLAGS_k7=" -msse -mno-sse2 -mno-sse3  -mfpmath=sse -m3dnow -mno-sse4a  -mno-ssse3 -mno-sse4.1 -mno-sse4.2 "
ARCHPROC_k7=" -march=athlon -mtune=generic -g0 -mpreferred-stack-boundary=3 -fno-stack-protector  -fno-strict-aliasing -fno-var-tracking-assignments"
EXTENSION_k7="k7"


# sse: AMD family 6 processors: Athlon Duron Thunderbird-core with mmx
#       optimized for speed over mmx and 3dnowext without x86-64
CFLAG_k6="  -Wall -Wextra -Wno-unused -Wno-unused-parameter -Wno-system-headers -Wno-uninitialized -Wno-missing-field-initializers -Wno-strict-aliasing  -Wno-conversion  -Wno-system-headers -Wno-empty-body -Wstrict-prototypes  -Wunsafe-loop-optimizations  -Wdisabled-optimization   -Wa,-msse-check=warning,-mtune=generic32 -g0 ${OPTIMIZE_k6} -fpeel-loops -fgcse-las -fgcse-sm -fomit-frame-pointer -momit-leaf-frame-pointer -mhard-float -march=winchip2  -mtune=athlon-tbird   -mmmx -m3dnow   -ffast-math -mpreferred-stack-boundary=2 -ffreestanding  -fno-exceptions -fno-math-errno -fno-trapping-math  -fno-jump-tables   -fno-var-tracking-assignments -fno-delete-null-pointer-checks  -fno-tracer -fno-stack-protector   --param max-inline-insns-single=131072 --param inline-unit-growth=350   "
GENFLAGS_k6=" -fmerge-all-constants "
ARCHFLAGS_k6=" -mno-sse -mno-sse2 -mno-sse3  -mfpmath=387 -m3dnow -mno-sse4a  -mno-ssse3 -mno-sse4.1 -mno-sse4.2   "
ARCHPROC_k6=" -march=winchip2    -mtune=generic -g0 -mpreferred-stack-boundary=2 -fno-stack-protector  -fno-strict-aliasing -fno-var-tracking-assignments"
EXTENSION_k6="k6"

# sse: AMD family 5 processors: early Athlon, Duron with mmx
#       optimized for speed over mmx 3dnow without x86-64 and 3dnowext
CFLAG_k5="  -Wall -Wextra -Wno-unused -Wno-unused-parameter -Wno-system-headers -Wno-uninitialized -Wno-missing-field-initializers -Wno-strict-aliasing  -Wno-conversion  -Wno-system-headers -Wno-empty-body -Wstrict-prototypes  -Wunsafe-loop-optimizations  -Wdisabled-optimization   -Wa,-msse-check=warning,-mtune=generic32 -g0 ${OPTIMIZE_k5} -fpeel-loops -fgcse-las -fgcse-sm  -fomit-frame-pointer -momit-leaf-frame-pointer -mhard-float   -march=winchip2 -mtune=generic  -mmmx -m3dnow -ffast-math   -mpreferred-stack-boundary=2 -ffreestanding  -fno-exceptions -fno-math-errno -fno-trapping-math  -fno-jump-tables   -fno-var-tracking-assignments -fno-delete-null-pointer-checks  -fno-tracer -fno-stack-protector   --param max-inline-insns-single=131072 --param inline-unit-growth=350   "
GENFLAGS_k5=" -fmerge-all-constants "
ARCHFLAGS_k5=" -mno-sse -mno-sse2 -mno-sse3  -mfpmath=387 -m3dnow -mno-sse4a  -mno-ssse3 -mno-sse4.1 -mno-sse4.2  "
ARCHPROC_k5=" -march=winchip2  -mtune=generic -g0 -mmmx -m3dnow -mpreferred-stack-boundary=2 -fno-stack-protector  -fno-strict-aliasing -fno-var-tracking-assignments"
EXTENSION_k5="k5"

CFLAG_init="  -Wall -Wextra -Wno-unused -Wno-unused-parameter -Wno-system-headers -Wno-uninitialized -Wno-missing-field-initializers -Wno-strict-aliasing  -Wno-conversion  -Wno-system-headers -Wno-empty-body -Wstrict-prototypes  -Wunsafe-loop-optimizations  -Wdisabled-optimization   -Wa,-msse-check=warning,-mtune=generic32  ${OPTIMIZE_init} -g0 -mhard-float   -march=winchip2 -mtune=generic  -mno-mmx -mno-3dnow -mfancy-math-387   -mpreferred-stack-boundary=2 -ffreestanding  -fno-jump-tables   -fno-delete-null-pointer-checks   --param max-inline-insns-single=131072 --param inline-unit-growth=350   "
GENFLAGS_init=" -fmerge-all-constants "
ARCHFLAGS_init=" -mno-sse -mno-sse2 -mno-sse3  -mfpmath=387 -mno-sse4a  -mno-ssse3 -mno-sse4.1 -mno-sse4.2  "
ARCHPROC_init=" -march=winchip2  -mtune=generic -mpreferred-stack-boundary=2   -fno-strict-aliasing -fno-var-tracking-assignments"
EXTENSION_init="init"

CFLAG_soft="  -Wall -Wextra -Wno-unused -Wno-unused-parameter -Wno-system-headers -Wno-uninitialized -Wno-missing-field-initializers -Wno-strict-aliasing  -Wno-conversion  -Wno-system-headers -Wno-empty-body -Wstrict-prototypes  -Wunsafe-loop-optimizations  -Wdisabled-optimization   -Wa,-msse-check=warning,-mtune=generic32  ${OPTIMIZE_soft} -g0  -march=winchip2 -mtune=generic  -mmmx -mno-3dnow -ffreestanding -fno-delete-null-pointer-checks  -fno-var-tracking-assignments  --param max-inline-insns-single=131072 --param inline-unit-growth=350   "
GENFLAGS_soft=" -fmerge-all-constants "
ARCHFLAGS_soft=" -mmmx -mno-sse -mno-sse2 -mno-sse3 -mno-sse4a  -mno-ssse3 -mno-sse4.1 -mno-sse4.2  "
ARCHPROC_soft=" -march=winchip2  -mtune=generic -fno-strict-aliasing -fno-var-tracking-assignments"
EXTENSION_soft="soft"

# sse4.1/sse4.2, generic sse4x: Intel core i3 i5 i7 with SSE4.1 and SSE4.2 Nehalem, AMD Core Zambezi/Bulldozer FX-4xxx,FX-6xxx,FX-8xxx
#       optimized for speed over sse4.x with EM64T/x86-64
CFLAG_corex="  -Wall -Wextra -Wno-unused -Wno-unused-parameter -Wno-system-headers -Wno-uninitialized -Wno-missing-field-initializers -Wno-strict-aliasing  -Wno-conversion  -Wno-system-headers -Wno-empty-body -Wstrict-prototypes  -Wunsafe-loop-optimizations  -Wdisabled-optimization   -Wa,-msse-check=warning,-mtune=generic32 -g0 ${OPTIMIZE_corex}  -fgcse-las -fgcse-sm  -fomit-frame-pointer -momit-leaf-frame-pointer -mhard-float   -march=corei7     -mtune=corei7  -mmmx -mno-3dnow -fpeel-loops  -ffast-math  -mfpmath=387   -mpreferred-stack-boundary=4 -ffreestanding  -fno-exceptions -fno-math-errno -fno-trapping-math  -fno-jump-tables   -fno-var-tracking-assignments -fno-delete-null-pointer-checks  -fno-tracer -fno-stack-protector   --param max-inline-insns-single=131072 --param inline-unit-growth=350   "
GENFLAGS_corex=" -fmerge-all-constants "
ARCHFLAGS_corex=" -msse -msse2 -msse3 -mssse3 -msse4 -mfpmath=387 -m128bit-long-double -mno-3dnow -mno-sse4a  "
ARCHPROC_corex=" -march=corei7 -mtune=generic -mmmx -mpreferred-stack-boundary=4 -fno-stack-protector  -fno-strict-aliasing -fno-var-tracking-assignments"
EXTENSION_corex="corex"

# sse4.x: AMD family 16 processors: FX-Zambezi-Bulldozer / AthlonII-Xi-Zambezi-Bulldozer  with XOP, FMA4, SSSE3, SSE4.1, SSE4.2, AVX, AES, CLMUL
#       optimized for speed over sse4.x 3dnowext with EM64T/x86-64
CFLAG_k15="  -Wall -Wextra -Wno-unused -Wno-unused-parameter -Wno-system-headers -Wno-uninitialized -Wno-missing-field-initializers -Wno-strict-aliasing  -Wno-conversion -Wno-override-init  -Wno-system-headers -Wno-empty-body -Wstrict-prototypes  -Wunsafe-loop-optimizations  -Wdisabled-optimization   -Wa,-msse-check=warning  -g0 ${OPTIMIZE_k15} -funsafe-loop-optimizations  -fexpensive-optimizations   -fomit-frame-pointer -momit-leaf-frame-pointer -mhard-float  -march=bdver1  -mtune=bdver1   -mmmx -m3dnow -ffast-math -mssse3 -msse4 -msse4a -mcx16 -msahf -mpclmul -mpopcnt -mabm -mlwp -mno-fma4 -mno-fma -mxop -mavx  -msse4.2 -msse4.1 -mlzcnt  -mprfchw -mfxsr -mxsave -msse2avx  -mpreferred-stack-boundary=4 -ffreestanding  -fno-exceptions -fno-math-errno -fno-trapping-math  -fno-jump-tables   -fno-delete-null-pointer-checks  -fno-var-tracking-assignments -fno-tracer -fno-stack-protector   --param max-inline-insns-single=131072 --param inline-unit-growth=350 "
#  -mno-fma4 -mno-fma -mno-xop -mno-lwp  -DCONFIG_AS_AVX=1 -DCONFIG_AS_AVX2=0"
GENFLAGS_k15=" -fmerge-all-constants "
ARCHFLAGS_k15=" -msse2avx "
#  -mcx16 -msahf -msse -msse2 -msse3 -mssse3 -msse4a -msse4.1 -msse4.2 "
ARCHPROC_k15=" -march=bdver1 -mtune=generic  -g0 -mpreferred-stack-boundary=4 -fno-stack-protector -fno-strict-aliasing -fno-var-tracking-assignments"
EXTENSION_k15="k15"
# these are found by -march=native on FX6100:
# -march=bdver1 -mcx16 -msahf -mno-movbe -maes -mpclmul -mpopcnt -mabm -mlwp -mno-fma -mfma4 -mxop -mno-bmi -mno-bmi2 -mno-tbm -mavx -mno-avx2 -msse4.2 -msse4.1 -mlzcnt -mno-rtm -mno-hle -mno-rdrnd -mno-f16c -mno-fsgsbase -mno-rdseed -mprfchw -mno-adx -mfxsr -mxsave -mno-xsaveopt -m32 -mtune=generic
# old ones before gcc-4.8.1: -march=bdver1 -mcx16 -msahf -mno-movbe -maes -mpclmul -mpopcnt -mabm -mlwp -mno-fma -mfma4 -mxop -mno-bmi -mno-bmi2 -mno-tbm -mavx -mno-avx2 -msse4.2 -msse4.1 -mlzcnt -mno-rdrnd -mno-f16c -mno-fsgsbase
# sse4.x: AMD family 16 processors: FX-Zambezi-Bulldozer / AthlonII-Xi-Zambezi-Bulldozer  with XOP, FMA4, SSSE3, SSE4.1, SSE4.2, AVX, AES, CLMUL
#       optimized for speed over sse4.x 3dnowext with EM64T/x86-64
#CFLAG_k15="  -Wall -Wextra -Wno-unused -Wno-unused-parameter -Wno-system-headers -Wno-uninitialized -Wno-missing-field-initializers -Wno-strict-aliasing  -Wno-conversion  -Wno-system-headers -Wno-empty-body -Wstrict-prototypes  -Wunsafe-loop-optimizations  -Wdisabled-optimization   -Wa,-msse-check=warning,-mtune=generic32  -g0 ${OPTIMIZE_k15} -fpeel-loops -fgcse-las -fgcse-sm  -fomit-frame-pointer -momit-leaf-frame-pointer -mhard-float   -march=bdver1  -mtune=amdfam10  -mmmx -m3dnow  -ffast-math -mfpmath=387   -mpreferred-stack-boundary=4 -ffreestanding  -fno-exceptions -fno-math-errno -fno-trapping-math  -fno-jump-tables   -fno-delete-null-pointer-checks  -fno-tracer -fno-stack-protector   --param max-inline-insns-single=131072 --param inline-unit-growth=350 "
#GENFLAGS_k15=" -fmerge-all-constants "
#ARCHFLAGS_k15=" -mcx16 -msahf -msse -msse2 -msse3  -m128bit-long-double -m3dnow -msse4a -mssse3 -msse4.1 -msse4.2 -mfpmath=sse -msseregparm"
#ARCHPROC_k15=" -march=bdver1 -mtune=generic -g0 -mpreferred-stack-boundary=4 -fno-stack-protector -fno-strict-aliasing "
#EXTENSION_k15="k15"

CFLAG_nativek15="  -Wall -Wextra -Wno-unused -Wno-unused-parameter -Wno-system-headers -Wno-uninitialized -Wno-missing-field-initializers -Wno-strict-aliasing  -Wno-conversion  -Wno-system-headers -Wno-empty-body -Wstrict-prototypes  -Wunsafe-loop-optimizations -Wdisabled-optimization   -Wa,-msse-check=warning   ${OPTIMIZE_nativek15} -g0 -march=native  -mtune=native  -mhard-float  -mcx16 -msahf -ffast-math -mssse3  -msse4a -msse4.1 -msse4.2 -msse2avx  -fexpensive-optimizations  -funsafe-loop-optimizations  -ffreestanding -fno-stack-protector  -fno-var-tracking-assignments -fno-delete-null-pointer-checks -fno-tracer -fno-jump-tables  --param max-inline-insns-single=131072 --param inline-unit-growth=350   "
GENFLAGS_nativek15=" -fmerge-all-constants "
ARCHFLAGS_nativek15=" -mavx -msse -msse2 -msse3 -msse4a -mssse3  -msse4.1 -msse4.2 -msse2avx "
ARCHPROC_nativek15=" -march=native -mtune=generic  -g0 -mpreferred-stack-boundary=4 -fno-stack-protector -fno-strict-aliasing -fno-var-tracking-assignments"
EXTENSION_nativek15="nativek15"

CFLAG_k14="  -Wall -Wextra -Wno-unused -Wno-unused-parameter -Wno-system-headers -Wno-uninitialized -Wno-missing-field-initializers -Wno-strict-aliasing  -Wno-conversion  -Wno-system-headers -Wno-empty-body -Wstrict-prototypes  -Wunsafe-loop-optimizations  -Wdisabled-optimization   -Wa,-msse-check=warning,-mtune=generic32   ${OPTIMIZE_k14} -g0 -march=amdfam10  -mtune=btver1  -mhard-float -m3dnow -mmmx  -ffast-math -ffreestanding  -fno-tracer -fno-jump-tables -fno-stack-protector -fno-delete-null-pointer-checks  -fno-var-tracking-assignments --param max-inline-insns-single=131072 --param inline-unit-growth=350   "
GENFLAGS_k14=" -fmerge-all-constants "
ARCHFLAGS_k14=" -mfpmath=sse -mcx16 -msahf -msse -msse2 -msse3 -msse4a -mssse3  -mno-sse4.1 -mno-sse4.2 "
ARCHPROC_k14=" -march=amdfam10 -mtune=generic  -g0 -mpreferred-stack-boundary=4 -fno-stack-protector -fno-strict-aliasing -fno-var-tracking-assignments"
EXTENSION_k14="k14"

CFLAG_k16="  -Wall -Wextra -Wno-unused -Wno-unused-parameter -Wno-system-headers -Wno-uninitialized -Wno-missing-field-initializers -Wno-strict-aliasing  -Wno-conversion  -Wno-system-headers -Wno-empty-body -Wstrict-prototypes  -Wunsafe-loop-optimizations  -Wdisabled-optimization   -Wa,-msse-check=warning,-mtune=generic32   ${OPTIMIZE_k16} -g0 -march=btver2   -mtune=btver2  -mhard-float -m3dnow -mmmx -ffast-math -mavx -msse4 -msse4a  -mcx16 -msahf -msse2avx -mno-movbe -mno-fma -mno-fma4   -ffreestanding  -fno-tracer -fno-jump-tables -fno-stack-protector -fno-delete-null-pointer-checks  -fno-var-tracking-assignments  --param max-inline-insns-single=131072 --param inline-unit-growth=350   "
GENFLAGS_k16=" -fmerge-all-constants "
ARCHFLAGS_k16=" -msse2avx "
ARCHPROC_k16=" -march=btver2 -mtune=generic  -g0 -mpreferred-stack-boundary=4 -fno-stack-protector -fno-strict-aliasing -fno-var-tracking-assignments"
EXTENSION_k16="k16"

CFLAG_nativeavx="  -Wall -Wextra -Wno-unused -Wno-unused-parameter -Wno-system-headers -Wno-uninitialized -Wno-missing-field-initializers -Wno-strict-aliasing  -Wno-conversion  -Wno-system-headers -Wno-empty-body -Wstrict-prototypes  -Wunsafe-loop-optimizations  -Wdisabled-optimization   -Wa,-msse-check=warning   ${OPTIMIZE_nativeavx} -g0 -march=native   -mtune=native  -mhard-float -mno-3dnow -mmmx -ffast-math -mavx -mno-sse4a -msse2avx -fexpensive-optimizations -funsafe-loop-optimizations  -ffreestanding  -fno-delete-null-pointer-checks  -fno-var-tracking-assignments  --param max-inline-insns-single=131072 --param inline-unit-growth=350   "
GENFLAGS_nativeavx=" -fmerge-all-constants "
ARCHFLAGS_nativeavx=" -mmmx -mno-3dnow -msse -msse2 -msse3 -mno-sse4a -msse4.1 -msse4.2 -mavx  -msse2avx "
ARCHPROC_nativeavx=" -march=native  -mtune=generic  -g0 -mpreferred-stack-boundary=4 -fno-stack-protector -fno-strict-aliasing -fno-var-tracking-assignments"
EXTENSION_nativeavx="nativeavx"

CFLAG_nativefpu="  -Wall -Wextra -Wno-unused -Wno-unused-parameter -Wno-system-headers -Wno-uninitialized -Wno-missing-field-initializers -Wno-strict-aliasing  -Wno-conversion  -Wno-system-headers -Wno-empty-body -Wstrict-prototypes   -Wdisabled-optimization   -Wa,-msse-check=warning   ${OPTIMIZE_nativefpu} -g0 -march=i686   -mtune=native  -mhard-float -mno-3dnow -mmmx -ffast-math -mno-sse  -fexpensive-optimizations -funsafe-loop-optimizations  -ffreestanding -fno-tracer -fno-jump-tables -fno-stack-protector -fno-delete-null-pointer-checks  -fno-var-tracking-assignments  --param max-inline-insns-single=131072 --param inline-unit-growth=350 "
GENFLAGS_nativefpu=" -fmerge-all-constants "
ARCHFLAGS_nativefpu=" -ffast-math -mmmx -mno-3dnow "
ARCHPROC_nativefpu=" -march=i686 -mtune=generic   -g0 -mpreferred-stack-boundary=4 -fno-stack-protector -fno-strict-aliasing -fno-var-tracking-assignments"
EXTENSION_nativefpu="nativefpu"


CFLAG_allmodmmx="  -Wall -Wextra -Wno-unused -Wno-unused-parameter -Wno-system-headers -Wno-uninitialized -Wno-missing-field-initializers -Wno-strict-aliasing  -Wno-conversion  -Wno-system-headers -Wno-empty-body -Wstrict-prototypes  -Wunsafe-loop-optimizations  -Wdisabled-optimization   -Wa,-msse-check=warning   ${OPTIMIZE_allmodmmx} -g0 -march=i686  -mtune=generic  -mhard-float -mno-3dnow -mmmx -ffast-math -mfpmath=387 -mno-ssse3 -mno-sse -mno-sse2 -mno-sse3 -mno-sse4 -mno-sse4a -fexpensive-optimizations -funsafe-loop-optimizations -ffreestanding -fno-tracer -fno-jump-tables -fno-stack-protector -fno-delete-null-pointer-checks   -fno-var-tracking-assignments  --param max-inline-insns-single=131072 --param inline-unit-growth=350 "
GENFLAGS_allmodmmx=" -fmerge-all-constants "
ARCHFLAGS_allmodmmx="  -ffast-math -mno-3dnow -mno-avx -mmmx -mno-sse -mno-sse2 -mno-sse3 -mno-sse4 -mno-ssse3  -mno-sse4a  "
ARCHPROC_allmodmmx=" -march=i686 -mtune=generic  -g0 -mpreferred-stack-boundary=4 -fno-stack-protector -fno-strict-aliasing -fno-var-tracking-assignments"
EXTENSION_allmodmmx="allmodmmx"


# obsoleted with gcc 4.3.3/4.4 since kernel 2.6.30:
# -funroll-loops :  does lead to "Setup too big!".
# '-O2 -fpeel-loops -fgcse-las -fgcse-sm' is the maximal possible optimization
# do not lead to significant optimization at higher than 1.5GHz level:
# -funsafe-loop-optimizations  -fgcse-after-reload
# no longer needed for kernel consistency :
#                   -fno-toplevel-reorder -fno-align-labels
# forbidden cause of failure or possibly causing code inconsistemcy leading to system freeze:
#   -fshort-enums  -ftree-vectorize -mieee-fp
#

OPTEXT=""
FLAGS=""
GENFLAG=""
ARCHFLAG=""
PROCFLAG=""
EXTENT=""

assign_variables()
{
  local E
  E=$1
  FLAGS="FLAGS=\"\$CFLAG_$E\""
  OPTEXT="OPTEXT=\"\$OPTIMIZE_$E\""
  GENFLAG="GENFLAG=\"\$GENFLAGS_$E\""
  ARCHFLAG="ARCHFLAG=\"\$ARCHFLAGS_$E\""
  PROCFLAG="PROCFLAG=\"\$ARCHPROC_$E\""
  EXTENT="EXTENT=\"\$EXTENSION_$E\""
  eval "$FLAGS"
  eval "$OPTEXT"
  eval "$GENFLAG"
  eval "$ARCHFLAG"
  eval "$PROCFLAG"
  eval "$EXTENT"
}

assign_extent()
{
 local  E  i
 ext=""
 arch=""
 E=$1
##i=1
 for arch in $EXTENTS; do
   if [ "$E" = "$arch" ]; then
    echo "current extent : $arch (= $E ) "
    assign_variables "$arch"
    break
   fi
#   i=$(( $i + 1 ))
 done

}

VERSION=""
PATCHLEVEL=""
SUBLEVEL=""
EXTRAVERSION=""
LOCALVERSION=""
KERNELVERSION=""

assign_kernelversion()
{
  local cfgfile mkfile
  mkfile=$1
  cfgfile=$2
  if [ -e $mkfile ]; then
  if [ -e $cfgfile ]; then

    VERSION=`/bin/busybox grep "VERSION =" <  $mkfile | /bin/busybox  cut -f2  -d "=" | /bin/busybox  cut -f1 -d '-' | /bin/busybox  cut -f1 -d '.' | /bin/busybox  cut -f1 -d '$' | /bin/busybox  tr -d " \n"`
    PATCHLEVEL=`/bin/busybox grep "PATCHLEVEL = " < $mkfile  | /bin/busybox cut -f2 -d= | /bin/busybox  tr -d ' \n'`
    SUBLEVEL=`/bin/busybox grep "SUBLEVEL = " <  $mkfile  | /bin/busybox cut -f2 -d= | /bin/busybox  tr -d ' \n'`
    EXTRAVERSION=`/bin/busybox grep "EXTRAVERSION = " <  $mkfile  | /bin/busybox cut -f2 -d= | /bin/busybox  tr -d ' \n'`
    LOCALVERSION=`/bin/busybox grep "CONFIG_LOCALVERSION=" <  $cfgfile  | /bin/busybox cut -f2 -d= | /bin/busybox tr -d ' \n' | /bin/busybox tr -d '\"'`
    KERNELVERSION=$VERSION.$PATCHLEVEL.$SUBLEVEL$EXTRAVERSION$LOCALVERSION
    echo "Assigned Kernel Version $KERNELVERSION from $mkfile for $cfgfile"
  else
    echo "Configfile $cfgfile not found!"
    exit 254
  fi
  else
    echo "Makefile $mkfile not found!"
    exit 254
  fi
}
